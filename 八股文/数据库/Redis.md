### 1、redis支持哪些数据类型？

Redis支持五种数据类型：
* string(字符串)
* hash(哈希) 
* list(列表)
* set(集合)
* zset(sorted set:有序集合)

### 2、zset底层数据结构是什么，查询时间复杂度和删除的时间复杂度分别是多少？

zset底层的存储结构包括`ziplist`或`skiplist`，在**同时**满足以下两个条件的时候使用ziplist，其他时候使用skiplist(跳表)：

* 有序集合保存的元素数量小于128个；
* 有序集合保存的所有元素的长度小于64字节；

时间复杂度

* ziplist：本质类似一个双向链表，时间复杂度为O(N)
* skiplist：跳表的实现，其实和二分查找的思路相似，查询、插入、删除的时间复杂度均为O(logN)

参考：https://juejin.cn/post/6863258283483807752

### 3、Redis为什么是单线程的？

注意：redis 单线程指的是网络请求模块使用了一个线程，即一个线程处理所有网络请求，其他模块仍用了多个线程。

因为CPU不是Redis的瓶颈。Redis的瓶颈最有可能是机器内存或者网络带宽。既然CPU不会成为瓶颈，单线程也避免了不必要的上下文切换和竞争条件，那就顺理成章地采用单线程的方案了。

### 4、单线程的Redis为什么这么快？

1. 完全基于内存，绝大部分请求是纯粹的内存操作，非常快速。数据存在内存中；
2. 数据结构简单，对数据操作也简单，Redis中的数据结构是专门进行设计的；
3. 采用单线程，避免了不必要的上下文切换和竞争条件，也不存在多进程或者多线程导致的切换而消耗 CPU，不用去考虑各种锁的问题，不存在加锁释放锁操作，没有因为可能出现死锁而导致的性能消耗；
4. 使用多路I/O复用模型，非阻塞IO；

### 5、为什么Redis需要把所有数据放到内存中？

Redis为了达到最快的读写速度将数据都读到内存中，并通过异步的方式将数据写入磁盘。所以Redis具有快速和数据持久化的特征。如果不将数据放在内存中，磁盘I/O速度为严重影响Redis的性能。在内存越来越便宜的今天，Redis将会越来越受欢迎。

如果设置了最大使用的内存，则数据已有记录数达到内存限值后不能继续插入新值。

### 6、Redis三种删除策略和六种淘汰策略？

删除策略：

1. 定时删除：在设置键的过期时间的同时，创建⼀个定时器，当键达到过期时间时，⽴即执⾏对键的删除操作；
2. 惰性删除：放任键过期不管，但在每次从键空间获取键时，都检查取得的键是否过期，如果过期的话，就删除该键，不返回任何东西；如
果没有过期，就返回该键；
3. 定期删除：每隔⼀点时间，程序就对数据库进⾏⼀次检查，删除⾥⾯的过期键，⾄于要删除多少过期键，以及要检查多少个数据库，则由
算法决定。默认每隔100ms随机抽取⼀些设计过期时间的key去检查是否过期。
   
淘汰策略：

1. 【noeviction】不删除策略，达到最⼤内存，再插⼊直接报错；
2. 【allkeys-lru】所有key通⽤，优先删除最少使⽤的key；
3. 【volatile-lru】所有设置过期的key，优先删除最少使⽤的key；
4. 【allkeys-random】所有key通⽤，随机删除⼀部分key；
5. 【volatile-random】所有设置过期的key，随机删除⼀部分key；
6. 【volatile-ttl】所有设置过期的key，删除剩余时间(Time to live)最少的key。

### 7、说说Redis中持久化机制？

Redis持久化是把内存中的数据同步到硬盘文件中，当Redis重启后再将硬盘文件内容重新加载到内存以实现数据恢复的目的。

具体持久化机制是单独fork()一个子进程，将当前父进程的数据库数据复制到子进程的内存中，然后由子进程写入到临时文件中，持久化的过程结束了，再用这个临时文件替换上次的快照文件，然后子进程退出，内存释放。

具体持久化方式，分别为RDB和AOF方式。

### 8、Redis持久化 RDB 机制与 AOF 机制的区别？

* RDB持久化：是Redis默认的持久化方式，即按照一定的时间周期策略把**内存的数据**以快照的形式保存到硬盘的二进制文件。即**快照存储**，对应产生的数据文件为`dump.rdb`
* AOF持久化：以日志的形式记录服务器所处理的每一个写、删除操作，查询操作不会记录。以文本的方式记录，可以打开文件看到详细的操作记录。

简单理解，一个是记录内存数据的副本，一个是记录增、删的操作流水。
